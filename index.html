<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Petopia</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dela+Gothic+One&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary: #6C5CE7;
            --secondary: #A29BFE;
            --accent: #FD79A8;
            --dark: #2D3436;
            --light: #F5F6FA;
            --success: #00B894;
            --warning: #FDCB6E;
            --danger: #E17055;
            --info: #0984E3;
            --bg-gradient: linear-gradient(135deg, #6C5CE7 0%, #A29BFE 100%);
            --card-bg: white;
            --text-color: #2D3436;
            --text-light: #636E72;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background: var(--light);
            color: var(--text-color);
            -webkit-font-smoothing: antialiased;
            transition: all 0.3s ease;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 0 10px;
            min-height: 100vh;
        }
        
        /* Эффект загрузки */
        .loader-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-gradient);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 0.5s ease;
        }
        
        .loader {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .loader-text {
            color: white;
            font-family: 'Dela Gothic One', cursive;
            font-size: 24px;
            margin-top: 20px;
        }
        
        .loader-progress {
            width: 80%;
            max-width: 200px;
            height: 6px;
            background: rgba(255,255,255,0.3);
            border-radius: 3px;
            margin-top: 20px;
            overflow: hidden;
        }
        
        .loader-progress-bar {
            height: 100%;
            width: 0%;
            background: white;
            transition: width 0.3s ease;
        }
        
        /* Основной интерфейс */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            margin-bottom: 15px;
        }
        
        .header-title {
            font-family: 'Dela Gothic One', cursive;
            font-size: 24px;
            background: var(--bg-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .settings-btn {
            background: none;
            border: none;
            font-size: 20px;
            color: var(--primary);
            cursor: pointer;
        }
        
        .currency-container {
            display: flex;
            gap: 10px;
        }
        
        .currency {
            display: flex;
            align-items: center;
            background-color: var(--card-bg);
            padding: 8px 12px;
            border-radius: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            font-weight: 700;
        }
        
        .currency-icon {
            margin-right: 5px;
            font-size: 18px;
        }
        
        .coins-icon {
            color: var(--warning);
        }
        
        .shards-icon {
            color: var(--primary);
        }
        
        /* Карточки питомцев */
        .pet-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            position: relative;
            overflow: hidden;
        }
        
        .no-pets-message {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-light);
            font-size: 16px;
        }
        
        .no-pets-message i {
            font-size: 40px;
            margin-bottom: 15px;
            color: var(--secondary);
        }
        
        .pet-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .pet-avatar {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            object-fit: cover;
            margin-right: 12px;
            background: var(--bg-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 28px;
        }
        
        .pet-name {
            font-family: 'Dela Gothic One', cursive;
            font-size: 18px;
            margin-bottom: 5px;
        }
        
        .pet-meta {
            font-size: 12px;
            color: var(--text-light);
            display: flex;
            gap: 8px;
        }
        
        .pet-meta i {
            margin-right: 3px;
            font-size: 14px;
        }
        
        /* Статистика */
        .stats {
            margin: 15px 0;
        }
        
        .stat {
            margin-bottom: 10px;
        }
        
        .stat-label {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            margin-bottom: 5px;
            color: var(--text-light);
        }
        
        .stat-bar {
            height: 8px;
            background-color: #EDEFF1;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .stat-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        .hunger-fill {
            background-color: var(--danger);
        }
        
        .happiness-fill {
            background-color: var(--success);
        }
        
        .health-fill {
            background-color: var(--info);
        }
        
        .energy-fill {
            background-color: var(--primary);
        }
        
        /* Кнопки действий */
        .actions {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-top: 15px;
        }
        
        .action-btn {
            border: none;
            background-color: var(--light);
            border-radius: 8px;
            padding: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .action-btn:hover {
            transform: translateY(-2px);
        }
        
        .action-btn i {
            font-size: 20px;
            margin-bottom: 5px;
        }
        
        .action-btn span {
            font-size: 10px;
            font-weight: 500;
        }
        
        .action-btn.primary {
            background-color: var(--primary);
            color: white;
        }
        
        .action-btn.success {
            background-color: var(--success);
            color: white;
        }
        
        .action-btn.warning {
            background-color: var(--warning);
            color: white;
        }
        
        .action-btn.danger {
            background-color: var(--danger);
            color: white;
        }
        
        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        /* Вкладки */
        .tabs {
            display: flex;
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 5px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .tab {
            flex: 1;
            text-align: center;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.2s;
        }
        
        .tab.active {
            background: var(--bg-gradient);
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Магазин */
        .shop-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--card-bg);
            padding: 12px 15px;
            border-radius: 12px;
            margin-bottom: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .shop-item-info {
            display: flex;
            align-items: center;
        }
        
        .shop-item-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            background: var(--bg-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            color: white;
            font-size: 20px;
        }
        
        .shop-item-name {
            font-weight: 500;
        }
        
        .shop-item-price {
            font-weight: 700;
            color: var(--primary);
        }
        
        .shop-item-price.coins {
            color: var(--warning);
        }
        
        .buy-btn {
            background: var(--bg-gradient);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .buy-btn.coins {
            background: linear-gradient(135deg, var(--warning) 0%, #E17055 100%);
        }
        
        .buy-btn:hover {
            opacity: 0.9;
        }
        
        .buy-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: #cccccc;
        }
        
        /* События */
        .event-message {
            background-color: var(--card-bg);
            padding: 12px 15px;
            border-radius: 12px;
            margin-bottom: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            font-size: 13px;
            border-left: 4px solid var(--primary);
        }
        
        .event-message.warning {
            border-left-color: var(--warning);
        }
        
        .event-message.danger {
            border-left-color: var(--danger);
        }
        
        .event-message.success {
            border-left-color: var(--success);
        }
        
        /* Мини-игры */
        .mini-game {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
        
        .game-title {
            font-family: 'Dela Gothic One', cursive;
            font-size: 16px;
            margin-bottom: 10px;
        }
        
        .clicker-btn {
            background: var(--bg-gradient);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 15px;
            font-size: 18px;
            font-weight: 700;
            width: 100%;
            cursor: pointer;
            transition: all 0.1s;
            margin-bottom: 10px;
        }
        
        .clicker-btn:active {
            transform: scale(0.98);
        }
        
        .color-options {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }
        
        .color-btn {
            flex: 1;
            height: 60px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .color-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .game-result {
            text-align: center;
            font-weight: 500;
            margin-top: 10px;
        }
        
        .success-text {
            color: var(--success);
        }
        
        .error-text {
            color: var(--danger);
        }
        
        /* Дом */
        .house-card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
        
        .house-image {
            width: 100%;
            height: 120px;
            background: var(--bg-gradient);
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 40px;
        }
        
        .upgrade-btn {
            background: var(--bg-gradient);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px;
            font-weight: 500;
            width: 100%;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .upgrade-btn:hover {
            opacity: 0.9;
        }
        
        /* Места для питомцев */
        .pet-spot {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            display: flex;
            align-items: center;
        }
        
        .pet-spot-icon {
            width: 40px;
            height: 40px;
            background-color: var(--light);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            color: var(--text-color);
        }
        
        .empty-spot {
            color: var(--text-light);
            font-size: 13px;
        }
        
        /* Настройки */
        .settings-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        
        .settings-panel.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .settings-content {
            background-color: var(--card-bg);
            width: 90%;
            max-width: 400px;
            border-radius: 16px;
            padding: 20px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .settings-title {
            font-family: 'Dela Gothic One', cursive;
            font-size: 20px;
        }
        
        .close-settings {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-light);
        }
        
        .theme-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .theme-option {
            height: 60px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 20px;
            transition: transform 0.2s;
        }
        
        .theme-option:hover {
            transform: scale(1.05);
        }
        
        .theme-option.active {
            border: 3px solid var(--dark);
        }
        
        /* Анимации */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 1.5s infinite;
        }
        
        /* Иконки животных */
        .pet-icon.dog {
            background: linear-gradient(135deg, #E17055 0%, #FDCB6E 100%);
        }
        
        .pet-icon.cat {
            background: linear-gradient(135deg, #FDCB6E 0%, #E17055 100%);
        }
        
        .pet-icon.hamster {
            background: linear-gradient(135deg, #00B894 0%, #0984E3 100%);
        }
        
        .pet-icon.parrot {
            background: linear-gradient(135deg, #0984E3 0%, #6C5CE7 100%);
        }
        
        .pet-icon.fish {
            background: linear-gradient(135deg, #6C5CE7 0%, #FD79A8 100%);
        }
        
        .pet-icon.rabbit {
            background: linear-gradient(135deg, #FD79A8 0%, #A29BFE 100%);
        }
        
        .pet-icon.turtle {
            background: linear-gradient(135deg, #00B894 0%, #2D3436 100%);
        }
        
        .pet-icon.ferret {
            background: linear-gradient(135deg, #2D3436 0%, #636E72 100%);
        }
    </style>
</head>
<body>
    <!-- Экран загрузки -->
    <div class="loader-container" id="loader">
        <div class="loader"></div>
        <div class="loader-text">Petopia</div>
        <div class="loader-progress">
            <div class="loader-progress-bar" id="loader-progress"></div>
        </div>
    </div>
    
    <!-- Основной интерфейс -->
    <div class="container" id="app" style="display: none;">
        <div class="header">
            <div class="header-title">Petopia</div>
            <div class="currency-container">
                <div class="currency">
                    <i class="fas fa-coins currency-icon coins-icon"></i>
                    <span id="coins">1000</span>
                </div>
                <div class="currency">
                    <i class="fas fa-gem currency-icon shards-icon"></i>
                    <span id="shards">50</span>
                </div>
            </div>
            <button class="settings-btn" id="settings-btn">
                <i class="fas fa-cog"></i>
            </button>
        </div>
        
        <div class="tabs">
            <div class="tab active" onclick="openTab('pets')"><i class="fas fa-paw"></i></div>
            <div class="tab" onclick="openTab('shop')"><i class="fas fa-shopping-cart"></i></div>
            <div class="tab" onclick="openTab('house')"><i class="fas fa-home"></i></div>
            <div class="tab" onclick="openTab('games')"><i class="fas fa-gamepad"></i></div>
        </div>
        
        <div id="pets" class="tab-content active">
            <div id="pets-list"></div>
            <div id="events-container"></div>
        </div>
        
        <div id="shop" class="tab-content">
            <h3>Животные</h3>
            <div id="animals-shop"></div>
            
            <h3>Товары</h3>
            <div id="items-shop"></div>
        </div>
        
        <div id="house" class="tab-content">
            <div class="house-card">
                <div class="house-image">
                    <i class="fas fa-home"></i>
                </div>
                <h3 id="current-house">Маленькая квартира</h3>
                <p>Уровень: <span id="house-level">1</span></p>
                <p>Мест для питомцев: <span id="pet-spots-count">2</span></p>
                <button class="upgrade-btn" onclick="upgradeHouse()">Улучшить за <span id="upgrade-cost">1000</span> <i class="fas fa-coins"></i></button>
            </div>
            
            <h3>Места для питомцев</h3>
            <div id="pet-spots-container"></div>
        </div>
        
        <div id="games" class="tab-content">
            <div class="mini-game">
                <h4 class="game-title">Кликер</h4>
                <p>Кликайте на кнопку, чтобы зарабатывать монеты</p>
                <button class="clicker-btn" onclick="clickerGame()">КЛИКАЙ!</button>
                <p>Заработано: <span id="clicker-counter">0</span> <i class="fas fa-coins"></i></p>
            </div>
            
            <div class="mini-game">
                <h4 class="game-title">Угадай цвет</h4>
                <p>Выберите правильный цвет, чтобы выиграть 100 монет</p>
                <div class="color-options">
                    <button class="color-btn" style="background-color: #E17055;" onclick="guessColor('red')"></button>
                    <button class="color-btn" style="background-color: #00B894;" onclick="guessColor('green')"></button>
                    <button class="color-btn" style="background-color: #0984E3;" onclick="guessColor('blue')"></button>
                </div>
                <p class="game-result" id="color-result"></p>
            </div>
        </div>
    </div>
    
    <!-- Панель настроек -->
    <div class="settings-panel" id="settings-panel">
        <div class="settings-content">
            <div class="settings-header">
                <div class="settings-title">Настройки</div>
                <button class="close-settings" id="close-settings">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <h3>Выберите тему</h3>
            <div class="theme-options">
                <div class="theme-option active" style="background: linear-gradient(135deg, #6C5CE7 0%, #A29BFE 100%);" onclick="setTheme('default')">
                    <i class="fas fa-check"></i>
                </div>
                <div class="theme-option" style="background: linear-gradient(135deg, #E17055 0%, #FDCB6E 100%);" onclick="setTheme('sunset')">
                    <i class="fas fa-sun"></i>
                </div>
                <div class="theme-option" style="background: linear-gradient(135deg, #00B894 0%, #0984E3 100%);" onclick="setTheme('ocean')">
                    <i class="fas fa-water"></i>
                </div>
                <div class="theme-option" style="background: linear-gradient(135deg, #FD79A8 0%, #A29BFE 100%);" onclick="setTheme('pink')">
                    <i class="fas fa-heart"></i>
                </div>
                <div class="theme-option" style="background: linear-gradient(135deg, #2D3436 0%, #636E72 100%);" onclick="setTheme('dark')">
                    <i class="fas fa-moon"></i>
                </div>
                <div class="theme-option" style="background: linear-gradient(135deg, #FDCB6E 0%, #E17055 100%);" onclick="setTheme('autumn')">
                    <i class="fas fa-leaf"></i>
                </div>
            </div>
            
            <button class="upgrade-btn" onclick="resetProgress()">
                <i class="fas fa-trash"></i> Сбросить прогресс
            </button>
        </div>
    </div>

    <script>
        // Инициализация Telegram WebApp
        const tg = window.Telegram.WebApp;
        tg.expand();
        
        // Темы приложения
        const themes = {
            default: {
                bgGradient: 'linear-gradient(135deg, #6C5CE7 0%, #A29BFE 100%)',
                primary: '#6C5CE7',
                secondary: '#A29BFE',
                accent: '#FD79A8',
                dark: '#2D3436',
                light: '#F5F6FA',
                success: '#00B894',
                warning: '#FDCB6E',
                danger: '#E17055',
                info: '#0984E3',
                cardBg: 'white',
                textColor: '#2D3436',
                textLight: '#636E72'
            },
            sunset: {
                bgGradient: 'linear-gradient(135deg, #E17055 0%, #FDCB6E 100%)',
                primary: '#E17055',
                secondary: '#FDCB6E',
                accent: '#FD79A8',
                dark: '#2D3436',
                light: '#F5F6FA',
                success: '#00B894',
                warning: '#FDCB6E',
                danger: '#E17055',
                info: '#0984E3',
                cardBg: 'white',
                textColor: '#2D3436',
                textLight: '#636E72'
            },
            ocean: {
                bgGradient: 'linear-gradient(135deg, #00B894 0%, #0984E3 100%)',
                primary: '#0984E3',
                secondary: '#00B894',
                accent: '#6C5CE7',
                dark: '#2D3436',
                light: '#F5F6FA',
                success: '#00B894',
                warning: '#FDCB6E',
                danger: '#E17055',
                info: '#0984E3',
                cardBg: 'white',
                textColor: '#2D3436',
                textLight: '#636E72'
            },
            pink: {
                bgGradient: 'linear-gradient(135deg, #FD79A8 0%, #A29BFE 100%)',
                primary: '#FD79A8',
                secondary: '#A29BFE',
                accent: '#6C5CE7',
                dark: '#2D3436',
                light: '#F5F6FA',
                success: '#00B894',
                warning: '#FDCB6E',
                danger: '#E17055',
                info: '#0984E3',
                cardBg: 'white',
                textColor: '#2D3436',
                textLight: '#636E72'
            },
            dark: {
                bgGradient: 'linear-gradient(135deg, #2D3436 0%, #636E72 100%)',
                primary: '#636E72',
                secondary: '#2D3436',
                accent: '#FD79A8',
                dark: '#2D3436',
                light: '#F5F6FA',
                success: '#00B894',
                warning: '#FDCB6E',
                danger: '#E17055',
                info: '#0984E3',
                cardBg: '#2D3436',
                textColor: '#F5F6FA',
                textLight: '#b2bec3'
            },
            autumn: {
                bgGradient: 'linear-gradient(135deg, #FDCB6E 0%, #E17055 100%)',
                primary: '#E17055',
                secondary: '#FDCB6E',
                accent: '#FD79A8',
                dark: '#2D3436',
                light: '#F5F6FA',
                success: '#00B894',
                warning: '#FDCB6E',
                danger: '#E17055',
                info: '#0984E3',
                cardBg: 'white',
                textColor: '#2D3436',
                textLight: '#636E72'
            }
        };
        
        // Игровые данные
        let gameData = {
            coins: 1000,
            shards: 50,
            pets: [],
            inventory: {
                dog_food: 0,
                cat_food: 0,
                hamster_food: 0,
                parrot_food: 0,
                fish_food: 0,
                rabbit_food: 0,
                turtle_food: 0,
                ferret_food: 0,
                toy: 2,
                medicine: 1
            },
            house: {
                level: 1,
                name: "Маленькая квартира",
                petSpots: 2
            },
            lastPlayed: Date.now(),
            events: [],
            settings: {
                theme: 'default'
            }
        };
        
        // Магазин животных
        const animalsShop = [
            // Питомцы за монеты
            { type: 'dog', age: 'puppy', name: 'Щенок', price: 500, currency: 'coins', icon: 'dog', income: 5 },
            { type: 'cat', age: 'kitten', name: 'Котенок', price: 400, currency: 'coins', icon: 'cat', income: 4 },
            { type: 'hamster', age: 'young', name: 'Хомяк', price: 200, currency: 'coins', icon: 'hamster', income: 2 },
            { type: 'fish', age: 'young', name: 'Рыбка', price: 150, currency: 'coins', icon: 'fish', income: 1 },
            { type: 'rabbit', age: 'young', name: 'Кролик', price: 300, currency: 'coins', icon: 'rabbit', income: 3 },
            
            // Питомцы за шарды (премиум)
            { type: 'parrot', age: 'young', name: 'Попугай', price: 100, currency: 'shards', icon: 'kiwi-bird', income: 10 },
            { type: 'turtle', age: 'young', name: 'Черепаха', price: 150, currency: 'shards', icon: 'turtle', income: 15 },
            { type: 'ferret', age: 'young', name: 'Хорек', price: 200, currency: 'shards', icon: 'ferret', income: 20 }
        ];
        
        // Магазин предметов
        const itemsShop = [
            { id: 'dog_food', name: 'Корм для собак', price: 50, currency: 'coins', icon: 'bone' },
            { id: 'cat_food', name: 'Корм для кошек', price: 40, currency: 'coins', icon: 'fish' },
            { id: 'hamster_food', name: 'Корм для хомяков', price: 20, currency: 'coins', icon: 'seedling' },
            { id: 'parrot_food', name: 'Корм для попугаев', price: 60, currency: 'coins', icon: 'seedling' },
            { id: 'fish_food', name: 'Корм для рыбок', price: 15, currency: 'coins', icon: 'fish' },
            { id: 'rabbit_food', name: 'Корм для кроликов', price: 30, currency: 'coins', icon: 'carrot' },
            { id: 'turtle_food', name: 'Корм для черепах', price: 70, currency: 'coins', icon: 'leaf' },
            { id: 'ferret_food', name: 'Корм для хорьков', price: 80, currency: 'coins', icon: 'drumstick-bite' },
            { id: 'toy', name: 'Игрушка', price: 30, currency: 'coins', icon: 'baseball-ball' },
            { id: 'medicine', name: 'Аптечка', price: 100, currency: 'coins', icon: 'briefcase-medical' }
        ];
        
        // Симуляция загрузки
        function simulateLoading() {
            let progress = 0;
            const loader = document.getElementById('loader');
            const progressBar = document.getElementById('loader-progress');
            const app = document.getElementById('app');
            
            const interval = setInterval(() => {
                progress += Math.random() * 10;
                if (progress > 100) progress = 100;
                progressBar.style.width = `${progress}%`;
                
                if (progress === 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        loader.style.opacity = '0';
                        setTimeout(() => {
                            loader.style.display = 'none';
                            app.style.display = 'block';
                            loadGame();
                        }, 500);
                    }, 500);
                }
            }, 200);
        }
        
        // Загрузка сохраненных данных
        function loadGame() {
            const savedData = localStorage.getItem('petopiaData');
            if (savedData) {
                const parsedData = JSON.parse(savedData);
                
                // Проверка времени с последнего входа
                const timeDiff = Date.now() - parsedData.lastPlayed;
                const hoursDiff = timeDiff / (1000 * 60 * 60);
                
                if (hoursDiff > 24) {
                    // Наказание за долгое отсутствие
                    parsedData.pets.forEach(pet => {
                        pet.hunger = Math.min(100, pet.hunger + hoursDiff * 5);
                        pet.happiness = Math.max(0, pet.happiness - hoursDiff * 3);
                        pet.health = Math.max(0, pet.health - hoursDiff * 2);
                        
                        // Шанс смерти питомца
                        if (pet.health <= 0 && Math.random() < 0.3) {
                            pet.isAlive = false;
                            gameData.events.push({
                                type: 'death',
                                petId: pet.id,
                                message: `${pet.name} (${getPetTypeName(pet.type)}) умер(ла) из-за вашего отсутствия!`
                            });
                        }
                    });
                }
                
                gameData = parsedData;
                
                // Применяем сохраненную тему
                if (gameData.settings && gameData.settings.theme) {
                    setTheme(gameData.settings.theme, true);
                }
            }
            
            renderShop();
            updateUI();
            startGameLoop();
            
            // Инициализация кнопок настроек
            document.getElementById('settings-btn').addEventListener('click', () => {
                document.getElementById('settings-panel').classList.add('active');
            });
            
            document.getElementById('close-settings').addEventListener('click', () => {
                document.getElementById('settings-panel').classList.remove('active');
            });
        }
        
        // Сохранение игры
        function saveGame() {
            gameData.lastPlayed = Date.now();
            localStorage.setItem('petopiaData', JSON.stringify(gameData));
        }
        
        // Основной игровой цикл
        function startGameLoop() {
            setInterval(() => {
                // Ухудшение состояния питомцев со временем
                gameData.pets.forEach(pet => {
                    if (pet.isAlive) {
                        pet.hunger = Math.min(100, pet.hunger + 2);
                        pet.happiness = Math.max(0, pet.happiness - 1);
                        
                        if (pet.hunger > 80) {
                            pet.health = Math.max(0, pet.health - 1);
                        }
                        
                        // Шанс случайного события
                        if (Math.random() < 0.05) {
                            triggerRandomEvent(pet);
                        }
                        
                        // Старение питомца
                        if (Math.random() < 0.01) {
                            pet.age++;
                            if (pet.age > getMaxAge(pet.type)) {
                                pet.isAlive = false;
                                gameData.events.push({
                                    type: 'death',
                                    petId: pet.id,
                                    message: `${pet.name} (${getPetTypeName(pet.type)}) умер(ла) от старости.`
                                });
                            }
                        }
                    }
                });
                
                // Пассивный доход от питомцев
                gameData.pets.forEach(pet => {
                    if (pet.isAlive) {
                        const animal = animalsShop.find(a => a.type === pet.type);
                        if (animal) {
                            gameData.coins += animal.income;
                        }
                    }
                });
                
                updateUI();
                saveGame();
            }, 10000); // Обновление каждые 10 секунд
        }
        
        // Рендер магазина
        function renderShop() {
            const animalsContainer = document.getElementById('animals-shop');
            animalsContainer.innerHTML = '';
            
            animalsShop.forEach(animal => {
                const animalElement = document.createElement('div');
                animalElement.className = 'shop-item';
                animalElement.innerHTML = `
                    <div class="shop-item-info">
                        <div class="shop-item-icon pet-icon ${animal.type}">
                            <i class="fas fa-${animal.icon}"></i>
                        </div>
                        <div>
                            <div class="shop-item-name">${animal.name}</div>
                            <div class="shop-item-price ${animal.currency}">${animal.price} ${animal.currency === 'coins' ? '<i class="fas fa-coins"></i>' : '<i class="fas fa-gem"></i>'}</div>
                            <div style="font-size: 12px; color: var(--text-light);">Доход: ${animal.income} <i class="fas fa-coins"></i>/10сек</div>
                        </div>
                    </div>
                    <button class="buy-btn ${animal.currency === 'coins' ? 'coins' : ''}" onclick="buyPet('${animal.type}', '${animal.age}', '${animal.currency}', ${animal.price})" ${gameData[animal.currency] < animal.price ? 'disabled' : ''}>
                        Купить
                    </button>
                `;
                animalsContainer.appendChild(animalElement);
            });
            
            const itemsContainer = document.getElementById('items-shop');
            itemsContainer.innerHTML = '';
            
            itemsShop.forEach(item => {
                // Проверяем, есть ли у игрока питомцы, для которых нужен этот корм
                let hasPetForFood = false;
                const petTypes = ['dog', 'cat', 'hamster', 'parrot', 'fish', 'rabbit', 'turtle', 'ferret'];
                
                for (const type of petTypes) {
                    if (item.id.includes(type) {
                        hasPetForFood = gameData.pets.some(pet => pet.type === type && pet.isAlive);
                        if (hasPetForFood) break;
                    }
                }
                
                // Для игрушек и аптечек всегда показываем
                if (item.id === 'toy' || item.id === 'medicine') {
                    hasPetForFood = true;
                }
                
                if (hasPetForFood) {
                    const itemElement = document.createElement('div');
                    itemElement.className = 'shop-item';
                    itemElement.innerHTML = `
                        <div class="shop-item-info">
                            <div class="shop-item-icon">
                                <i class="fas fa-${item.icon}"></i>
                            </div>
                            <div>
                                <div class="shop-item-name">${item.name}</div>
                                <div class="shop-item-price ${item.currency}">${item.price} ${item.currency === 'coins' ? '<i class="fas fa-coins"></i>' : '<i class="fas fa-gem"></i>'}</div>
                            </div>
                        </div>
                        <button class="buy-btn ${item.currency === 'coins' ? 'coins' : ''}" onclick="buyItem('${item.id}', '${item.currency}', ${item.price})" ${gameData[item.currency] < item.price ? 'disabled' : ''}>
                            Купить
                        </button>
                    `;
                    itemsContainer.appendChild(itemElement);
                }
            });
        }
        
        // Обновление интерфейса
        function updateUI() {
            // Обновление валют
            document.getElementById('coins').textContent = gameData.coins;
            document.getElementById('shards').textContent = gameData.shards;
            
            // Обновление списка питомцев
            const petsList = document.getElementById('pets-list');
            petsList.innerHTML = '';
            
            if (gameData.pets.length === 0) {
                petsList.innerHTML = `
                    <div class="no-pets-message">
                        <i class="fas fa-paw"></i>
                        <p>У вас пока нет питомцев</p>
                        <p>Посетите магазин, чтобы приобрести своего первого питомца!</p>
                    </div>
                `;
            } else {
                gameData.pets.forEach((pet, index) => {
                    const petElement = document.createElement('div');
                    petElement.className = 'pet-card';
                    
                    if (!pet.isAlive) {
                        petElement.innerHTML = `
                            <div class="pet-header">
                                <div class="pet-avatar pet-icon ${pet.type}">
                                    <i class="fas fa-${getPetIcon(pet.type)}"></i>
                                </div>
                                <div>
                                    <div class="pet-name">${pet.name}</div>
                                    <div class="pet-meta">
                                        <span><i class="fas fa-paw"></i> ${getPetTypeName(pet.type)}</span>
                                        <span><i class="fas fa-clock"></i> ${getAgeName(pet.age)}</span>
                                    </div>
                                </div>
                            </div>
                            <div style="text-align: center; padding: 20px; color: var(--danger);">
                                <i class="fas fa-skull" style="font-size: 24px;"></i>
                                <p>Питомец умер</p>
                            </div>
                        `;
                    } else {
                        const animal = animalsShop.find(a => a.type === pet.type);
                        const income = animal ? animal.income : 0;
                        
                        petElement.innerHTML = `
                            <div class="pet-header">
                                <div class="pet-avatar pet-icon ${pet.type}">
                                    <i class="fas fa-${getPetIcon(pet.type)}"></i>
                                </div>
                                <div>
                                    <div class="pet-name">${pet.name}</div>
                                    <div class="pet-meta">
                                        <span><i class="fas fa-paw"></i> ${getPetTypeName(pet.type)}</span>
                                        <span><i class="fas fa-${pet.gender === 'male' ? 'mars' : 'venus'}"></i> ${pet.gender === 'male' ? 'самец' : 'самка'}</span>
                                        <span><i class="fas fa-clock"></i> ${getAgeName(pet.age)}</span>
                                        <span><i class="fas fa-coins"></i> ${income}/10сек</span>
                                    </div>
                                </div>
                            </div>
                            <div class="stats">
                                <div class="stat">
                                    <div class="stat-label">
                                        <span>Голод</span>
                                        <span>${pet.hunger}%</span>
                                    </div>
                                    <div class="stat-bar">
                                        <div class="stat-fill hunger-fill" style="width: ${pet.hunger}%"></div>
                                    </div>
                                </div>
                                <div class="stat">
                                    <div class="stat-label">
                                        <span>Счастье</span>
                                        <span>${pet.happiness}%</span>
                                    </div>
                                    <div class="stat-bar">
                                        <div class="stat-fill happiness-fill" style="width: ${pet.happiness}%"></div>
                                    </div>
                                </div>
                                <div class="stat">
                                    <div class="stat-label">
                                        <span>Здоровье</span>
                                        <span>${pet.health}%</span>
                                    </div>
                                    <div class="stat-bar">
                                        <div class="stat-fill health-fill" style="width: ${pet.health}%"></div>
                                    </div>
                                </div>
                                <div class="stat">
                                    <div class="stat-label">
                                        <span>Энергия</span>
                                        <span>${pet.energy}%</span>
                                    </div>
                                    <div class="stat-bar">
                                        <div class="stat-fill energy-fill" style="width: ${pet.energy}%"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="actions">
                                <button class="action-btn ${hasFoodForPet(pet.type) ? 'primary' : ''}" onclick="feedPet(${index})" ${!hasFoodForPet(pet.type) ? 'disabled' : ''}>
                                    <i class="fas fa-utensils"></i>
                                    <span>Кормить</span>
                                </button>
                                <button class="action-btn success" onclick="playWithPet(${index})" ${gameData.inventory.toy <= 0 || pet.energy <= 20 ? 'disabled' : ''}>
                                    <i class="fas fa-gamepad"></i>
                                    <span>Играть</span>
                                </button>
                                <button class="action-btn warning" onclick="healPet(${index})" ${gameData.inventory.medicine <= 0 ? 'disabled' : ''}>
                                    <i class="fas fa-heartbeat"></i>
                                    <span>Лечить</span>
                                </button>
                                <button class="action-btn danger" onclick="sleepPet(${index})">
                                    <i class="fas fa-moon"></i>
                                    <span>Спать</span>
                                </button>
                            </div>
                        `;
                    }
                    
                    petsList.appendChild(petElement);
                });
            }
            
            // Обновление событий
            const eventsContainer = document.getElementById('events-container');
            eventsContainer.innerHTML = '';
            
            gameData.events.slice(-3).reverse().forEach(event => {
                const eventElement = document.createElement('div');
                eventElement.className = 'event-message';
                
                if (event.type === 'death') {
                    eventElement.classList.add('danger');
                } else if (event.type === 'income' || event.type === 'birth') {
                    eventElement.classList.add('success');
                } else if (event.type === 'bite' || event.type === 'fine') {
                    eventElement.classList.add('warning');
                }
                
                eventElement.textContent = event.message;
                eventsContainer.appendChild(eventElement);
            });
            
            // Обновление информации о доме
            document.getElementById('current-house').textContent = gameData.house.name;
            document.getElementById('house-level').textContent = gameData.house.level;
            document.getElementById('pet-spots-count').textContent = gameData.house.petSpots;
            document.getElementById('upgrade-cost').textContent = gameData.house.level * 1000;
            
            const petSpotsContainer = document.getElementById('pet-spots-container');
            petSpotsContainer.innerHTML = '';
            
            for (let i = 0; i < gameData.house.petSpots; i++) {
                const spot = document.createElement('div');
                spot.className = 'pet-spot';
                
                if (i < gameData.pets.length) {
                    const pet = gameData.pets[i];
                    const animal = animalsShop.find(a => a.type === pet.type);
                    const income = animal ? animal.income : 0;
                    
                    spot.innerHTML = `
                        <div class="pet-spot-icon pet-icon ${pet.type}">
                            <i class="fas fa-${getPetIcon(pet.type)}"></i>
                        </div>
                        <div>
                            <div>${pet.name}</div>
                            <div class="pet-meta">
                                <span><i class="fas fa-paw"></i> ${getPetTypeName(pet.type)}</span>
                                <span><i class="fas fa-coins"></i> ${income}/10сек</span>
                            </div>
                        </div>
                    `;
                } else {
                    spot.innerHTML = `
                        <div class="pet-spot-icon">
                            <i class="fas fa-plus"></i>
                        </div>
                        <div class="empty-spot">Свободное место</div>
                    `;
                }
                
                petSpotsContainer.appendChild(spot);
            }
            
            // Обновление магазина
            renderShop();
        }
        
        // Покупка питомца
        function buyPet(type, age, currency, price) {
            if (gameData[currency] >= price) {
                if (gameData.pets.length < gameData.house.petSpots) {
                    gameData[currency] -= price;
                    
                    const animal = animalsShop.find(a => a.type === type);
                    const animalName = animal ? animal.name : type;
                    
                    const newPet = {
                        id: Date.now(),
                        type: type,
                        name: generatePetName(type),
                        age: age === 'puppy' || age === 'kitten' ? 0 : 1,
                        hunger: 30,
                        happiness: 70,
                        health: 90,
                        energy: 80,
                        isAlive: true,
                        gender: Math.random() < 0.5 ? 'male' : 'female'
                    };
                    
                    gameData.pets.push(newPet);
                    gameData.events.push({
                        type: 'new_pet',
                        message: `Вы купили ${animalName} по имени ${newPet.name}!`
                    });
                    
                    updateUI();
                    saveGame();
                } else {
                    showAlert('В вашем доме нет места для нового питомца! Улучшите дом.');
                }
            } else {
                showAlert(`Недостаточно ${currency === 'coins' ? 'монет' : 'шардов'}!`);
            }
        }
        
        // Покупка предметов
        function buyItem(item, currency, price) {
            if (gameData[currency] >= price) {
                gameData[currency] -= price;
                gameData.inventory[item]++;
                gameData.events.push({
                    type: 'purchase',
                    message: `Вы купили ${getItemName(item)}`
                });
                
                updateUI();
                saveGame();
            } else {
                showAlert(`Недостаточно ${currency === 'coins' ? 'монет' : 'шардов'}!`);
            }
        }
        
        // Кормление питомца
        function feedPet(petIndex) {
            const pet = gameData.pets[petIndex];
            const foodType = `${pet.type}_food`;
            
            if (gameData.inventory[foodType] > 0) {
                gameData.inventory[foodType]--;
                pet.hunger = Math.max(0, pet.hunger - 30);
                pet.health = Math.min(100, pet.health + 5);
                gameData.events.push({
                    type: 'feed',
                    message: `Вы покормили ${pet.name}`
                });
                
                updateUI();
                saveGame();
            }
        }
        
        // Игра с питомцем
        function playWithPet(petIndex) {
            const pet = gameData.pets[petIndex];
            
            if (gameData.inventory.toy > 0 && pet.energy > 20) {
                gameData.inventory.toy--;
                pet.happiness = Math.min(100, pet.happiness + 20);
                pet.energy = Math.max(0, pet.energy - 20);
                
                // Шанс, что питомец укусит хозяина
                if (pet.happiness < 50 && Math.random() < 0.3) {
                    gameData.health = Math.max(0, gameData.health - 10);
                    gameData.events.push({
                        type: 'bite',
                        message: `${pet.name} укусил(а) вас! Вы плохо заботились о нем(ней).`
                    });
                } else {
                    gameData.events.push({
                        type: 'play',
                        message: `Вы поиграли с ${pet.name}`
                    });
                }
                
                updateUI();
                saveGame();
            }
        }
        
        // Лечение питомца
        function healPet(petIndex) {
            const pet = gameData.pets[petIndex];
            
            if (gameData.inventory.medicine > 0) {
                gameData.inventory.medicine--;
                pet.health = Math.min(100, pet.health + 30);
                gameData.events.push({
                    type: 'heal',
                    message: `Вы полечили ${pet.name}`
                });
                
                updateUI();
                saveGame();
            }
        }
        
        // Сон питомца
        function sleepPet(petIndex) {
            const pet = gameData.pets[petIndex];
            pet.energy = 100;
            gameData.events.push({
                type: 'sleep',
                message: `${pet.name} поспал(а) и восстановил(а) энергию`
            });
            
            updateUI();
            saveGame();
        }
        
        // Улучшение дома
        function upgradeHouse() {
            const upgradeCost = gameData.house.level * 1000;
            
            if (gameData.coins >= upgradeCost) {
                gameData.coins -= upgradeCost;
                gameData.house.level++;
                gameData.house.petSpots++;
                
                if (gameData.house.level <= 3) {
                    gameData.house.name = "Квартира среднего размера";
                } else if (gameData.house.level <= 6) {
                    gameData.house.name = "Большая квартира";
                } else {
                    gameData.house.name = "Частный дом";
                }
                
                gameData.events.push({
                    type: 'upgrade',
                    message: `Вы улучшили дом до уровня ${gameData.house.level}`
                });
                
                updateUI();
                saveGame();
            } else {
                showAlert(`Недостаточно монет! Нужно ${upgradeCost} <i class="fas fa-coins"></i>`);
            }
        }
        
        // Случайные события
        function triggerRandomEvent(pet) {
            const events = [
                {
                    chance: 0.2,
                    message: `${pet.name} (${getPetTypeName(pet.type)}) хочет играть!`,
                    effect: () => { pet.happiness = Math.max(0, pet.happiness - 10); }
                },
                {
                    chance: 0.1,
                    message: `${pet.name} (${getPetTypeName(pet.type)}) выглядит больным(ой)!`,
                    effect: () => { pet.health = Math.max(0, pet.health - 15); }
                },
                {
                    chance: 0.05,
                    message: `${pet.name} (${getPetTypeName(pet.type)}) укусил(а) прохожего! Вы должны заплатить штраф 200 монет.`,
                    effect: () => { gameData.coins = Math.max(0, gameData.coins - 200); }
                },
                {
                    chance: 0.03,
                    message: `${pet.name} (${getPetTypeName(pet.type)}) и ${getRandomPetName()} подружились!`,
                    effect: () => { 
                        pet.happiness = Math.min(100, pet.happiness + 20);
                        // Шанс на размножение
                        if (Math.random() < 0.3) {
                            const otherPet = getRandomPet();
                            if (otherPet && otherPet.gender !== pet.gender && pet.type === otherPet.type) {
                                const babyName = generatePetName(pet.type);
                                gameData.events.push({
                                    type: 'birth',
                                    message: `У ${pet.name} и ${otherPet.name} родился детеныш ${babyName}!`
                                });
                                
                                const newPet = {
                                    id: Date.now(),
                                    type: pet.type,
                                    name: babyName,
                                    age: 0,
                                    hunger: 40,
                                    happiness: 80,
                                    health: 100,
                                    energy: 90,
                                    isAlive: true,
                                    gender: Math.random() < 0.5 ? 'male' : 'female'
                                };
                                
                                if (gameData.pets.length < gameData.house.petSpots) {
                                    gameData.pets.push(newPet);
                                }
                            }
                        }
                    }
                }
            ];
            
            for (const event of events) {
                if (Math.random() < event.chance) {
                    event.effect();
                    gameData.events.push({
                        type: 'random_event',
                        message: event.message
                    });
                    break;
                }
            }
        }
        
        // Мини-игры для заработка
        let clickerCounter = 0;
        
        function clickerGame() {
            const earnings = Math.floor(Math.random() * 10) + 1;
            gameData.coins += earnings;
            clickerCounter += earnings;
            document.getElementById('clicker-counter').textContent = clickerCounter;
            updateUI();
            saveGame();
        }
        
        function guessColor(color) {
            const colors = ['red', 'green', 'blue'];
            const correctColor = colors[Math.floor(Math.random() * colors.length)];
            const resultElement = document.getElementById('color-result');
            
            if (color === correctColor) {
                gameData.coins += 100;
                resultElement.textContent = 'Правильно! Вы выиграли 100 монет';
                resultElement.className = 'game-result success-text';
            } else {
                resultElement.textContent = `Неправильно! Правильный цвет был ${correctColor === 'red' ? 'красный' : correctColor === 'green' ? 'зеленый' : 'синий'}`;
                resultElement.className = 'game-result error-text';
            }
            
            updateUI();
            saveGame();
        }
        
        // Настройки темы
        function setTheme(themeName, initial = false) {
            const theme = themes[themeName];
            if (!theme) return;
            
            // Обновляем CSS переменные
            document.documentElement.style.setProperty('--bg-gradient', theme.bgGradient);
            document.documentElement.style.setProperty('--primary', theme.primary);
            document.documentElement.style.setProperty('--secondary', theme.secondary);
            document.documentElement.style.setProperty('--accent', theme.accent);
            document.documentElement.style.setProperty('--dark', theme.dark);
            document.documentElement.style.setProperty('--light', theme.light);
            document.documentElement.style.setProperty('--success', theme.success);
            document.documentElement.style.setProperty('--warning', theme.warning);
            document.documentElement.style.setProperty('--danger', theme.danger);
            document.documentElement.style.setProperty('--info', theme.info);
            document.documentElement.style.setProperty('--card-bg', theme.cardBg);
            document.documentElement.style.setProperty('--text-color', theme.textColor);
            document.documentElement.style.setProperty('--text-light', theme.textLight);
            
            // Обновляем активную тему в настройках
            if (!initial) {
                document.querySelectorAll('.theme-option').forEach(option => {
                    option.classList.remove('active');
                });
                
                document.querySelector(`.theme-option[onclick="setTheme('${themeName}')"]`).classList.add('active');
                
                // Сохраняем выбор темы
                gameData.settings.theme = themeName;
                saveGame();
            }
        }
        
        // Сброс прогресса
        function resetProgress() {
            if (confirm('Вы уверены, что хотите сбросить весь прогресс? Это действие нельзя отменить.')) {
                localStorage.removeItem('petopiaData');
                location.reload();
            }
        }
        
        // Вспомогательные функции
        function getPetIcon(type) {
            const icons = {
                dog: 'dog',
                cat: 'cat',
                hamster: 'hamster',
                parrot: 'kiwi-bird',
                fish: 'fish',
                rabbit: 'rabbit',
                turtle: 'turtle',
                ferret: 'ferret'
            };
            return icons[type];
        }
        
        function getPetTypeName(type) {
            const names = {
                dog: 'Собака',
                cat: 'Кошка',
                hamster: 'Хомяк',
                parrot: 'Попугай',
                fish: 'Рыбка',
                rabbit: 'Кролик',
                turtle: 'Черепаха',
                ferret: 'Хорек'
            };
            return names[type];
        }
        
        function getAgeName(age) {
            if (age === 0) return 'детеныш';
            if (age < 3) return 'молодой';
            if (age < 7) return 'взрослый';
            return 'пожилой';
        }
        
        function generatePetName(type) {
            const dogNames = ['Бобик', 'Шарик', 'Рекс', 'Джек', 'Барсик'];
            const catNames = ['Мурзик', 'Васька', 'Пушистик', 'Снежок', 'Рыжик'];
            const hamsterNames = ['Хома', 'Пушок', 'Чип', 'Дейл', 'Нюша'];
            const parrotNames = ['Кеша', 'Гоша', 'Рио', 'Лора', 'Арчи'];
            const fishNames = ['Немо', 'Дори', 'Бульк', 'Пузырь', 'Золотик'];
            const rabbitNames = ['Пушистик', 'Ушастик', 'Банни', 'Прыгун', 'Морковкин'];
            const turtleNames = ['Лео', 'Донни', 'Раф', 'Мики', 'Шелдон'];
            const ferretNames = ['Фредди', 'Лучик', 'Пушок', 'Зигги', 'Ферри'];
            
            const names = {
                dog: dogNames,
                cat: catNames,
                hamster: hamsterNames,
                parrot: parrotNames,
                fish: fishNames,
                rabbit: rabbitNames,
                turtle: turtleNames,
                ferret: ferretNames
            };
            
            return names[type][Math.floor(Math.random() * names[type].length)];
        }
        
        function getRandomPetName() {
            const pet = getRandomPet();
            return pet ? pet.name : 'другой питомец';
        }
        
        function getRandomPet() {
            const alivePets = gameData.pets.filter(p => p.isAlive && p.id !== currentPetId);
            return alivePets.length > 0 ? alivePets[Math.floor(Math.random() * alivePets.length)] : null;
        }
        
        function hasFoodForPet(type) {
            const foodType = `${type}_food`;
            return gameData.inventory[foodType] > 0;
        }
        
        function getItemName(item) {
            const names = {
                dog_food: 'корм для собак',
                cat_food: 'корм для кошек',
                hamster_food: 'корм для хомяков',
                parrot_food: 'корм для попугаев',
                fish_food: 'корм для рыбок',
                rabbit_food: 'корм для кроликов',
                turtle_food: 'корм для черепах',
                ferret_food: 'корм для хорьков',
                toy: 'игрушку',
                medicine: 'аптечку'
            };
            return names[item];
        }
        
        function getMaxAge(type) {
            const ages = {
                dog: 15,
                cat: 18,
                hamster: 4,
                parrot: 25,
                fish: 5,
                rabbit: 8,
                turtle: 50,
                ferret: 7
            };
            return ages[type];
        }
        
        function openTab(tabName) {
            // Скрыть все вкладки
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Убрать активный класс у всех кнопок вкладок
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Показать выбранную вкладку
            document.getElementById(tabName).classList.add('active');
            
            // Сделать кнопку вкладки активной
            event.currentTarget.classList.add('active');
        }
        
        function showAlert(message) {
            const alertElement = document.createElement('div');
            alertElement.className = 'event-message warning';
            alertElement.innerHTML = message;
            
            const eventsContainer = document.getElementById('events-container');
            eventsContainer.insertBefore(alertElement, eventsContainer.firstChild);
            
            setTimeout(() => {
                alertElement.remove();
            }, 3000);
        }
        
        // Инициализация игры
        window.onload = function() {
            simulateLoading();
        };
    </script>
</body>
</html>
